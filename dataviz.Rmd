---
title: "Individual Report B"
output: html_document
date: "2024-09-18"
---

```{r}
library(readxl)
library(tidyverse)
library(gt)
library(scales) 
df <- read_excel("Dataset-1.xlsx", 
    sheet = "Investment data")
```

## Data transformation


```{r}
df$`Historical Breach Resistance Data`[df$`Historical Breach Resistance Data` == "Very high"] <- 10
df$`Historical Breach Resistance Data`[df$`Historical Breach Resistance Data` == "High"] <- 7
df$`Historical Breach Resistance Data`[df$`Historical Breach Resistance Data` == "Moderate"] <- 4
df$`Historical Breach Resistance Data`[df$`Historical Breach Resistance Data` == "Low"] <- 1
```

```{r}
df$`(Expected) Data Quality Issues`[df$`(Expected) Data Quality Issues` == "Moderate"] <- 5.5
df$`(Expected) Data Quality Issues`[df$`(Expected) Data Quality Issues` == "Low"] <- 10
df$`(Expected) Data Quality Issues`[df$`(Expected) Data Quality Issues` == "High"] <- 1
df$`(Expected) Data Quality Issues` <- as.numeric(df$`(Expected) Data Quality Issues`)
```

## Data Visualization

```{r}
table1 <- df_22_24 %>%
  select(Technology, `Recorded Data Breaches`, `Historical Breach Resistance Data`) %>%
  group_by(Technology) %>%
  reframe(
    past_data_breaches = mean(`Recorded Data Breaches`), #* (-1),
    historical_breach_resistence = mean(`Historical Breach Resistance Data`)
  )

table2 <-df %>%
  select(Technology, `Regulatory Compliance Ease (1-10)`, `(Expected) Data Quality Issues`, `(Expected) Security Enhancement Level (1-10)` ) %>%
  group_by(Technology) %>%
  reframe(
    compliance_ease = mean(`Regulatory Compliance Ease (1-10)`),
    data_quality = mean(`(Expected) Data Quality Issues`),
    security_enhancement = mean(`(Expected) Security Enhancement Level (1-10)`)
    
  )

df_mean = merge(table1, table2) # Table 1 in report

```

```{r}
cor(df_mean$past_data_breaches, df_mean$historical_breach_resistence)
```


```{r}
# Construct good looking table

gt_table <- df_mean %>%
  gt() %>%
   fmt_number(
    decimals = 2
  ) %>%
   tab_style(
    style = cell_borders(
      sides = "all",        
      color = "black",      
      weight = px(1)        
    ),
    locations = cells_body() 
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "all",        
      color = "black",
      weight = px(1)
    ),
    locations = cells_column_labels() 
  ) %>%
gtsave("technology_security_index.html")



  

```

### Environmental Impact
```{r}

df %>%
  group_by(Technology) %>%
  reframe(
    environment = mean(`(Expected) Environmental Impact`)
  ) %>%
  ggplot(aes(x=Technology, y=environment, fill = Technology)) +
    geom_bar(stat="identity") +
    labs(y="Environmental Impact (%)") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") 
```
### Implementation Complexity

```{r}
df %>%
  group_by(Technology) %>%
  reframe(
    complexity = mean(`Implementation Complexity (1-10)`)
  ) %>%
  ggplot(aes(x=Technology, y=complexity, fill = Technology)) +
    geom_bar(stat="identity") +
    labs(y="Implementation Complexity") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") 
```
### Ranking by security index

```{r}
# Construct index
df_mean$security_index <- df_mean$historical_breach_resistence + df_mean$compliance_ease + df_mean$data_quality + df_mean$security_enhancement #df_mean$data_breaches

```



```{r}
ggplot(df_mean, aes(x=Technology, y=security_index, fill = Technology))+
  geom_bar(stat = "identity")+
   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") +
  labs(y="Security Index")
```

## Historic Data analysis

```{r}
df <- read_excel("Dataset-1.xlsx", 
    sheet = "Historical data")
```


```{r}
# Average data breach costs per year
sum(df$`Cost of Data Breaches (millions AUD)`) / length(df$`Cost of Data Breaches (millions AUD)`)
```

```{r}
ggplot(df, aes(x = Year)) +
  geom_line(aes(y = `Consumer Trust Index (1-10)`, color = "Trust Index (1-10)"), size = 1.2) +
  geom_line(aes(y = `Data Quality Issues`, color = "Recorded Data Quality issues"), size = 1.2) +
  geom_line(aes(y = `Recorded Data Breaches`, color = "Recorded Data Breaches"), size = 1.2) +
  geom_line(aes(y = `Cost of Data Breaches (millions AUD)`, color = "Data Breaches costs in millions AUD"), size = 1.2) +
  scale_x_continuous(breaks = c(2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024)) +
  scale_y_continuous(name="") +
  guides(color = guide_legend(title = "Security Dimensions"))

  

```
### Development cost testing

All technologies will incur initial implement costs, after which a decrease
of 15% on the initial costs will be encountered annually to further develop the
technology. Stopping with development after three years increases the risk of security
breaches.
```{r}

# Use this script to identify development costs for technologies

# First array and its sum
l1 <- c(15)
for (i in 1:3) {
  l1 <- c(l1, l1[i] * 0.85)
}
sum_l1 <- sum(l1)

# Second array and its sum
l2 <- c(45)
for (i in 1:4) {
  l2 <- c(l2, l2[i] * 0.85)
}
sum_l2 <- sum(l2)

costs = sum_l2 + sum_l1 + 10
print(costs)
# Check if the investment is financially possible
print(paste("Investment financially possible?:", costs < 225))


  


```

